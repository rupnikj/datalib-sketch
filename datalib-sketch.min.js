!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n;n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,(n.dl||(n.dl={})).sketch=t()}}(function(){return function t(n,r,e){function i(s,u){if(!r[s]){if(!n[s]){var h="function"==typeof require&&require;if(!u&&h)return h(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var a=r[s]={exports:{}};n[s][0].call(a.exports,function(t){var r=n[s][1][t];return i(r?r:t)},a,a.exports,t,n,r,e)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<e.length;s++)i(e[s]);return i}({1:[function(t,n,r){function e(t,n){t=t||u,n=n||h;var r;"number"!=typeof t&&(r=t,t=32*r.length);var e,i=Math.ceil(t/32),c=-1;if(this._w=t=32*i,this._d=n,s){if(e=this._buckets=new Int32Array(i),r)for(;++c<i;)e[c]=r[c]}else if(e=this._buckets=[],r)for(;++c<i;)e[c]=r[c];else for(;++c<i;)e[c]=0;o.init.call(this)}function i(t){return t-=t>>1&1431655765,t=(858993459&t)+(t>>2&858993459),16843009*(t+(t>>4)&252645135)>>24}var o=t("./hash"),s="undefined"!=typeof ArrayBuffer,u=8388608,h=5;e.create=function(t,n){var r=-t*Math.log(n)/(Math.LN2*Math.LN2),i=r/t*Math.LN2;return new e(~~r,~~i)},e["import"]=function(t){return new e(t.bits,t.depth)};var c=e.prototype;c.locations=o.locations,c.add=function(t){for(var n=this.locations(t+""),r=-1,e=this._d,i=this._buckets;++r<e;)i[Math.floor(n[r]/32)]|=1<<n[r]%32},c.query=function(t){for(var n,r=this.locations(t+""),e=-1,i=this._d,o=this._buckets;++e<i;)if(n=r[e],0===(o[Math.floor(n/32)]&1<<n%32))return!1;return!0},c.size=function(){var t,n,r=this._buckets,e=0;for(t=0,n=r.length;n>t;++t)e+=i(r[t]);return-this._w*Math.log(1-e/this._w)/this._d},c.union=function(t){if(t._w!==this._w)throw"Filter widths do not match.";if(t._d!==this._d)throw"Filter depths do not match.";var n,r=this._buckets,i=t._buckets,o=r.length,u=s?new Int32Array(o):Array(o);for(n=0;o>n;++n)u[n]=r[n]|i[n];return new e(u,this._d)},c._estimate=function(t,n){if(t._w!==this._w)throw"Filter widths do not match.";if(t._d!==this._d)throw"Filter depths do not match.";var r,e,o,s,u=this._buckets,h=t._buckets,c=u.length;for(s=r=e=o=0;c>s;++s)r+=i(u[s]),e+=i(h[s]),o+=i(u[s]|h[s]);return r=Math.log(1-r/this._w),e=Math.log(1-e/this._w),o=Math.log(1-o/this._w),n(r,e,o)},c.jaccard=function(t){return this._estimate(t,function(t,n,r){return r?(t+n)/r-1:0})},c.cover=function(t){return this._estimate(t,function(t,n,r){var e=Math.max(t,n);return e?(t+n-r)/e:0})},c["export"]=function(){return{depth:this._d,bits:[].slice.call(this._buckets)}},n.exports=e},{"./hash":4}],2:[function(t,n,r){function e(t,n,r){s.call(this,t,n,r),this._q=Array(n)}function i(t){t.sort(o);var n=t.length,r=~~(n/2);return n%2?t[r]:.5*(t[r-1]+t[r])}function o(t,n){return t-n}var s=t("./count-min");e.create=s.create,e["import"]=s["import"];var u=e.prototype=Object.create(s.prototype);u.query=function(t){var n,r,e,o=this.locations(t+""),s=this._table,u=this._q,h=this._w,c=this._d,a=this._num,f=1/(h-1),l=+(1/0);for(r=0,e=0;c>r;++r,e+=h)n=s[e+o[r]],l>n&&(l=n),n-=(a-n)*f,u[r]=n;return(n=i(u))<0?0:n>l?l:n},u.dot=function(t){if(this._w!==t._w)throw"Sketch widths do not match.";if(this._d!==t._d)throw"Sketch depths do not match.";var n=this._table,r=t._table,e=this._q,o=this._w,s=this._num,u=this._d*o,h=(o-1)/o,c=1/(o-1),a=0,f=0;do a+=(n[f]-(s-n[f])*c)*(r[f]-(s-r[f])*c),++f%o===0&&(e[f/o-1]=h*a,a=0);while(u>f);return(a=i(e))<0?0:a},n.exports=e},{"./count-min":3}],3:[function(t,n,r){function e(t,n,r){t=t||s,n=n||u;var e,h,c,a=-1;if("number"!=typeof t&&(e=t,t=e.length/n),this._w=t,this._d=n,this._num=r||0,c=t*n,o){if(h=this._table=new Int32Array(c),e)for(;++a<c;)h[a]=e[a]}else{if(h=this._table=Array(c),e)for(;++a<c;)h[a]=e[a];for(;++a<c;)h[a]=0}i.init.call(this)}var i=t("./hash"),o="undefined"!=typeof ArrayBuffer,s=27191,u=9;e.create=function(t,n,r){n=t?n?n/t:1/t:.001,r=r||.001;var e=Math.ceil(Math.E/n),i=Math.ceil(-Math.log(r));return new this(e,i)},e["import"]=function(t){return new this(t.counts,t.depth,t.num)};var h=e.prototype;h.locations=i.locations,h.add=function(t){var n,r,e=this.locations(t+""),i=this._table,o=this._w,s=this._d;for(n=0,r=0;s>n;++n,r+=o)i[r+e[n]]+=1;this._num+=1},h.query=function(t){var n,r,e,i=+(1/0),o=this.locations(t+""),s=this._table,u=this._w,h=this._d;for(n=0,r=0;h>n;++n,r+=u)e=s[r+o[n]],i>e&&(i=e);return i},h.dot=function(t){if(this._w!==t._w)throw"Sketch widths do not match.";if(this._d!==t._d)throw"Sketch depths do not match.";var n=this._table,r=t._table,e=this._w,i=this._d*e,o=+(1/0),s=0,u=0;do s+=n[u]*r[u],++u%e===0&&(o>s&&(o=s),s=0);while(i>u);return o},h["export"]=function(){return{num:this._num,depth:this._d,counts:[].slice.call(this._table)}},n.exports=e},{"./hash":4}],4:[function(t,n,r){function e(t){for(var n,r,e=t.length,i=2166136261,o=-1;++o<e;)n=t.charCodeAt(o),(r=4278190080&n)&&(i^=r>>24,i+=(i<<1)+(i<<4)+(i<<7)+(i<<8)+(i<<24)),(r=16711680&n)&&(i^=r>>16,i+=(i<<1)+(i<<4)+(i<<7)+(i<<8)+(i<<24)),(r=65280&n)&&(i^=r>>8,i+=(i<<1)+(i<<4)+(i<<7)+(i<<8)+(i<<24)),i^=255&n,i+=(i<<1)+(i<<4)+(i<<7)+(i<<8)+(i<<24);return i+=i<<13,i^=i>>7,i+=i<<3,i^=i>>17,i+=i<<5,4294967295&i}function i(t){return t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24),t+=t<<13,t^=t>>7,t+=t<<3,t^=t>>17,t+=t<<5,4294967295&t}var o="undefined"!=typeof ArrayBuffer;n.exports.init=function(){var t=this._d,n=this._w;if(o){var r=1<<Math.ceil(Math.log(Math.ceil(Math.log(n)/Math.LN2/8))/Math.LN2),e=1===r?Uint8Array:2===r?Uint16Array:Uint32Array,i=new ArrayBuffer(r*t);this._locations=new e(i)}else this._locations=[]},n.exports.locations=function(t){for(var n=this._d,r=this._w,o=this._locations,s=e(t),u=i(s),h=-1,c=s%r;++h<n;)o[h]=0>c?c+r:c,c=(c+u)%r;return o},n.exports.fnv_1a=e,n.exports.fnv_1a_b=i},{}],5:[function(t,n,r){n.exports={Bloom:t("./bloom"),CountMin:t("./count-min"),CountMeanMin:t("./count-mean-min"),NGram:t("./ngram"),StreamSummary:t("./stream-summary")}},{"./bloom":1,"./count-mean-min":2,"./count-min":3,"./ngram":6,"./stream-summary":7}],6:[function(t,n,r){function e(t,n,r){this._n=null==t?2:t,this._case=!!n,this._map=r||{},this._norm=null}function i(t,n,r,e){var i,o,s=t.length-n+1;for(o=0;s>o;++o)i=t.substr(o,n),r||(i=i.toLowerCase()),e[i]=e[i]?e[i]+1:1}e["import"]=function(t){return new e(t.n,t["case"],t.counts)};var o=e.prototype;o.add=function(t){null!=t&&""!==t&&(this._norm=null,i(String(t),this._n,this._case,this._map))},o.query=function(t){return this._map[this._case?t:t.toLowerCase()]||0},o.size=function(){return Object.keys(this._map).length},o.norm=function(){if(null==this._norm){var t,n=this._map,r=0;for(t in n)r+=n[t]*n[t];this._norm=Math.sqrt(r)}return this._norm},o.dot=function(t){var n,r=this._map,e=t._map,i=0;for(n in r)i+=r[n]*(e[n]||0);return i},o.cosine=function(t){var n=this.norm(),r=t.norm();return n&&r?this.dot(t)/(n*r):0},o["export"]=function(){return{n:this._n,"case":this._case,counts:this._map}},n.exports=e},{}],7:[function(t,n,r){function e(t){this._w=t||h,this._values={},this._buckets={count:-1},this._buckets.next=this._buckets,this._buckets.prev=this._buckets,this._size=0}function i(t){var n={count:t};return n.next=n,n.prev=n,n.list={},n.list.prev=n.list,n.list.next=n.list,n}function o(t,n){return{bucket:n,value:t,count:0,error:0}}function s(t,n){var r=t.next;return n.next=r,n.prev=t,t.next=n,r.prev=n,n}function u(t){var n=t.next,r=t.prev;r.next=n,n.prev=r}var h=100;e["import"]=function(t){var n,r,u,h,c,a,f,l=new e(t.w),_=l._buckets;for(n=0,r=t.buckets.length;r>n;++n)for(u=t.buckets[n],h=s(_.prev,i(u[0])),c=1,a=u.length;a>c;c+=2)f=s(h.list.prev,o(u[c],h)),f.count=h.count,f.error=u[c+1],l._size+=1;return l};var c=e.prototype;c.add=function(t,n){n=n||1;var r,e=this._values[t];null==e&&(this._size<this._w?(r=s(this._buckets,i(0)),e=s(r.list,o(t,r)),this._size+=1):(r=this._buckets.next,e=r.list.next,delete this._values[e.value],e.value=t,e.error=r.count),this._values[t]=e),this._increment(e,n)},c._increment=function(t,n){var r=this._buckets,e=t.bucket,o=e,h=o.next;for(u(t),t.count+=n;h!==r;){if(t.count===h.count){s(h.list,t);break}t.count>h.count?(o=h,h=o.next):h=r}h===r&&(h=i(t.count),s(h.list,t),s(o,h)),t.bucket=h,e.list.next===e.list&&u(e)},c.query=function(t){var n=this._values[t];return n?n.count:0},c.error=function(t){var n=this._values[t];return n?n.error:-1},c.values=function(t){return this.collect(t,function(t){return t.value})},c.counts=function(t){return this.collect(t,function(t){return t.count})},c.errors=function(t){return this.collect(t,function(t){return t.error})},c.collect=function(t,n){if(0===t)return[];(null==t||0>t)&&(t=this._size);var r,e,i,o=Array(t),s=this._buckets,u=0;for(r=s.prev;r!==s;r=r.prev)for(e=r.list,i=e.prev;i!==e;i=i.prev)if(o[u++]=n(i),u===t)return o;return o},c["export"]=function(){var t,n,r,e=this._buckets,i=[];for(t=e.next;t!==e;t=t.next){for(r=[t.count],n=t.list.next;n!==t.list;n=n.next)r.push(n.value,n.error);i.push(r)}return{w:this._w,buckets:i}},n.exports=e},{}]},{},[5])(5)});