!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n;n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,(n.dl||(n.dl={})).sketch=t()}}(function(){return function t(n,i,r){function e(s,h){if(!i[s]){if(!n[s]){var a="function"==typeof require&&require;if(!h&&a)return a(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var f=i[s]={exports:{}};n[s][0].call(f.exports,function(t){var i=n[s][1][t];return e(i?i:t)},f,f.exports,t,n,i,r)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)e(r[s]);return e}({1:[function(t,n,i){function r(t,n){t=t||h,n=n||a;var i;"number"!=typeof t&&(i=t,t=32*i.length);var r,e=Math.ceil(t/32),u=-1;if(this._w=t=32*e,this._d=n,s){if(r=this._buckets=new Int32Array(e),i)for(;++u<e;)r[u]=i[u]}else if(r=this._buckets=[],i)for(;++u<e;)r[u]=i[u];else for(;++u<e;)r[u]=0;o.init.call(this)}function e(t){return t-=t>>1&1431655765,t=(858993459&t)+(t>>2&858993459),16843009*(t+(t>>4)&252645135)>>24}var o=t("./hash"),s="undefined"!=typeof ArrayBuffer,h=8388608,a=5;r.create=function(t,n){var i=-t*Math.log(n)/(Math.LN2*Math.LN2),e=i/t*Math.LN2;return new r(~~i,~~e)},r["import"]=function(t){return new r(t.bits,t.depth)};var u=r.prototype;u.locations=o.locations,u.add=function(t){for(var n=this.locations(t+""),i=-1,r=this._d,e=this._buckets;++i<r;)e[Math.floor(n[i]/32)]|=1<<n[i]%32},u.query=function(t){for(var n,i=this.locations(t+""),r=-1,e=this._d,o=this._buckets;++r<e;)if(n=i[r],0===(o[Math.floor(n/32)]&1<<n%32))return!1;return!0},u.size=function(){var t,n,i=this._buckets,r=0;for(t=0,n=i.length;n>t;++t)r+=e(i[t]);return-this._w*Math.log(1-r/this._w)/this._d},u.union=function(t){if(t._w!==this._w)throw"Filter widths do not match.";if(t._d!==this._d)throw"Filter depths do not match.";var n,i=this._buckets,e=t._buckets,o=i.length,h=s?new Int32Array(o):Array(o);for(n=0;o>n;++n)h[n]=i[n]|e[n];return new r(h,this._d)},u._estimate=function(t,n){if(t._w!==this._w)throw"Filter widths do not match.";if(t._d!==this._d)throw"Filter depths do not match.";var i,r,o,s,h=this._buckets,a=t._buckets,u=h.length;for(s=i=r=o=0;u>s;++s)i+=e(h[s]),r+=e(a[s]),o+=e(h[s]|a[s]);return i=Math.log(1-i/this._w),r=Math.log(1-r/this._w),o=Math.log(1-o/this._w),n(i,r,o)},u.jaccard=function(t){return this._estimate(t,function(t,n,i){return(t+n)/i-1})},u.cover=function(t){return this._estimate(t,function(t,n,i){return(t+n-i)/Math.max(t,n)})},u["export"]=function(){return{depth:this._d,bits:[].slice.call(this._buckets)}},n.exports=r},{"./hash":4}],2:[function(t,n,i){function r(t,n,i){s.call(this,t,n,i),this._q=Array(n)}function e(t){t.sort(o);var n=t.length,i=~~(n/2);return n%2?t[i]:.5*(t[i-1]+t[i])}function o(t,n){return t-n}var s=t("./count-min");r.create=s.create,r["import"]=s["import"];var h=r.prototype=Object.create(s.prototype);h.query=function(t){var n,i,r,o=this.locations(t+""),s=this._table,h=this._q,a=this._w,u=this._d,f=this._num,c=1/(a-1),_=+(1/0);for(i=0,r=0;u>i;++i,r+=a)n=s[r+o[i]],_>n&&(_=n),n-=(f-n)*c,h[i]=n;return(n=e(h))<0?0:n>_?_:n},h.dot=function(t){if(this._w!==t._w)throw"Sketch widths do not match.";if(this._d!==t._d)throw"Sketch depths do not match.";var n=this._table,i=t._table,r=this._q,o=this._w,s=this._num,h=this._d*o,a=(o-1)/o,u=1/(o-1),f=0,c=0;do f+=(n[c]-(s-n[c])*u)*(i[c]-(s-i[c])*u),++c%o===0&&(r[c/o-1]=a*f,f=0);while(h>c);return(f=e(r))<0?0:f},n.exports=r},{"./count-min":3}],3:[function(t,n,i){function r(t,n,i){t=t||s,n=n||h;var r,a,u,f=-1;if("number"!=typeof t&&(r=t,t=r.length/n),this._w=t,this._d=n,this._num=i||0,u=t*n,o){if(a=this._table=new Int32Array(u),r)for(;++f<u;)a[f]=r[f]}else{if(a=this._table=Array(u),r)for(;++f<u;)a[f]=r[f];for(;++f<u;)a[f]=0}e.init.call(this)}var e=t("./hash"),o="undefined"!=typeof ArrayBuffer,s=27191,h=9;r.create=function(t,n,i){n=t?n?n/t:1/t:.001,i=i||.001;var r=Math.ceil(Math.E/n),e=Math.ceil(-Math.log(i));return new this(r,e)},r["import"]=function(t){return new this(t.counts,t.depth,t.num)};var a=r.prototype;a.locations=e.locations,a.add=function(t){var n,i,r=this.locations(t+""),e=this._table,o=this._w,s=this._d;for(n=0,i=0;s>n;++n,i+=o)e[i+r[n]]+=1;this._num+=1},a.query=function(t){var n,i,r,e=+(1/0),o=this.locations(t+""),s=this._table,h=this._w,a=this._d;for(n=0,i=0;a>n;++n,i+=h)r=s[i+o[n]],e>r&&(e=r);return e},a.dot=function(t){if(this._w!==t._w)throw"Sketch widths do not match.";if(this._d!==t._d)throw"Sketch depths do not match.";var n=this._table,i=t._table,r=this._w,e=this._d*r,o=+(1/0),s=0,h=0;do s+=n[h]*i[h],++h%r===0&&(o>s&&(o=s),s=0);while(e>h);return o},a["export"]=function(){return{num:this._num,depth:this._d,counts:[].slice.call(this._table)}},n.exports=r},{"./hash":4}],4:[function(t,n,i){function r(t){for(var n,i,r=t.length,e=2166136261,o=-1;++o<r;)n=t.charCodeAt(o),(i=4278190080&n)&&(e^=i>>24,e+=(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24)),(i=16711680&n)&&(e^=i>>16,e+=(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24)),(i=65280&n)&&(e^=i>>8,e+=(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24)),e^=255&n,e+=(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24);return e+=e<<13,e^=e>>7,e+=e<<3,e^=e>>17,e+=e<<5,4294967295&e}function e(t){return t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24),t+=t<<13,t^=t>>7,t+=t<<3,t^=t>>17,t+=t<<5,4294967295&t}var o="undefined"!=typeof ArrayBuffer;n.exports.init=function(){var t=this._d,n=this._w;if(o){var i=1<<Math.ceil(Math.log(Math.ceil(Math.log(n)/Math.LN2/8))/Math.LN2),r=1===i?Uint8Array:2===i?Uint16Array:Uint32Array,e=new ArrayBuffer(i*t);this._locations=new r(e)}else this._locations=[]},n.exports.locations=function(t){for(var n=this._d,i=this._w,o=this._locations,s=r(t),h=e(s),a=-1,u=s%i;++a<n;)o[a]=0>u?u+i:u,u=(u+h)%i;return o},n.exports.fnv_1a=r,n.exports.fnv_1a_b=e},{}],5:[function(t,n,i){n.exports={Bloom:t("./bloom"),CountMin:t("./count-min"),CountMeanMin:t("./count-mean-min"),NGram:t("./ngram")}},{"./bloom":1,"./count-mean-min":2,"./count-min":3,"./ngram":6}],6:[function(t,n,i){function r(t,n,i){this._n=null==t?2:t,this._case=!!n,this._map=i||{},this._norm=null}function e(t,n,i,r){var e,o,s=t.length-n+1;for(o=0;s>o;++o)e=t.substr(o,n),i||(e=e.toLowerCase()),r[e]=r[e]?r[e]+1:1}r["import"]=function(t){return new r(t.n,t["case"],t.counts)};var o=r.prototype;o.add=function(t){null!=t&&""!==t&&(this._norm=null,e(String(t),this._n,this._case,this._map))},o.query=function(t){return this._map[this._case?t:t.toLowerCase()]||0},o.size=function(){return Object.keys(this._map).length},o.norm=function(){if(null==this._norm){var t,n=this._map,i=0;for(t in n)i+=n[t]*n[t];this._norm=Math.sqrt(i)}return this._norm},o.dot=function(t){var n,i=this._map,r=t._map,e=0;for(n in i)e+=i[n]*(r[n]||0);return e},o.cosine=function(t){var n=this.norm(),i=t.norm();return this.dot(t)/(n*i)},o["export"]=function(){return{n:this._n,"case":this._case,counts:this._map}},n.exports=r},{}]},{},[5])(5)});